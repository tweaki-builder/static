;
(self.AMP=self.AMP||[]).push({m:1,v:"2510081644000",n:"amp-video-docking",ev:"0.1",l:!0,f:function(t,i){(()=>{function i(t,i,o){return i in t?Object.defineProperty(t,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[i]=o,t}function o(t,i){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);i&&(e=e.filter((function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable}))),o.push.apply(o,e)}return o}var e,s,n,{isArray:r}=Array,{hasOwnProperty:a,toString:h}=Object.prototype;function d(t){const i=Object.create(null);return t&&Object.assign(i,t),i}function c(t,i,o,e,s,n,r,a,h,d,c){return t}function l(t,i){t.classList.add("i-amphtml-fill-content"),i&&t.classList.add("i-amphtml-replaced-content")}function u(t,i,o,e){return{left:t,top:i,width:o,height:e,bottom:i+e,right:t+o,x:t,y:i}}function m(t){const i=t.ownerDocument||t;return s&&s.ownerDocument===i||(s=i.createElement("div")),p}function p(t){return function(t,i){if(c(1===i.length),c(Array.isArray(i)||(o=i,a.call(o,"raw"))),self.trustedTypes&&self.trustedTypes.createPolicy){const o=self.trustedTypes.createPolicy("static-template#createNode",{createHTML:function(t){return i[0]}});t.innerHTML=o.createHTML("ignored")}else t.innerHTML=i[0];var o;const e=t.firstElementChild;return c(e),c(!e.nextElementSibling),t.removeChild(e),e}(s,t)}function v(t){const i=t.querySelectorAll("[ref]"),o=d();for(let t=0;t<i.length;t++){const e=i[t],s=e.getAttribute("ref");c(s),e.removeAttribute("ref"),c(void 0===o[s]),o[s]=e}return o}function g(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:o,stack:e}=t,s=new Error(o);for(const i in t)s[i]=t[i];return s.stack=e,s}function _(t){let i=null,o="";for(const t of arguments)t instanceof Error&&!i?i=g(t):(o&&(o+=" "),o+=t);return i?o&&(i.message=o+": "+i.message):i=new Error(o),i}function f(t){const i=_.apply(null,arguments);return i.expected=!0,i}function k(t,...i){var o,e,s;o=f.apply(null,i),null===(e=(s=self).__AMP_REPORT_ERROR)||void 0===e||e.call(s,o)}var A=["Webkit","webkit","Moz","moz","ms","O","o"];function P(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return A.some((t=>i.startsWith(t+"-")))?`-${i}`:i}function b(t,i,o){if(i.startsWith("--"))return i;n||(n=d());let e=n[i];if(!e||o){if(e=i,void 0===t[i]){const o=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),s=function(t,i){for(let o=0;o<A.length;o++){const e=A[o]+i;if(void 0!==t[e])return e}return""}(t,o);void 0!==t[s]&&(e=s)}o||(n[i]=e)}return e}function M(t,i){const{style:o}=t;for(const t in i)o.setProperty(P(b(o,t)),String(i[t]),"important")}function w(t,i,o,e,s){const n=b(t.style,i,s);if(!n)return;const r=e?o+e:o;t.style.setProperty(P(n),r)}function T(t,i){void 0===i&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden","")}function V(t){return`${t}px`}function x(t,i){return"number"==typeof t?i(t):t}function E(t,i){return null==i?`translate(${x(t,V)})`:`translate(${x(t,V)}, ${x(i,V)})`}function R(t,i){for(let o=0;o<i.length;o++)w(t,i[o],null)}function y(t){return t.querySelector("video, iframe")}function I(t){let i=!1,o=null,e=t;return(...t)=>(i||(o=e.apply(self,t),i=!0,e=null),o)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var z=self.__AMP_LOG;function O(t){return z.user||(z.user=H()),function(t,i){return i&&i.ownerDocument.defaultView!=t}(z.user.win,t)?z.userForEmbed||(z.userForEmbed=H()):z.user}function H(t){return function(t,i){throw new Error("failed to call initLogConstructor")}()}function B(t,i,o,e,s,n,r,a,h,d,c){return t}function D(t,i,o,e,s,n,r,a,h,d,c){return O().assert(t,i,o,e,s,n,r,a,h,d,c)}function j(t,i){return L(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function S(t,i){return L(C($(t)),i)}function $(t){return t.nodeType?(o=t,i=(o.ownerDocument||o).defaultView,j(i,"ampdoc")).getAmpDoc(t):t;var i,o}function C(t){const i=$(t);return i.isSingleDoc()?i.win:i}function L(t,i){B(N(t,i));const o=function(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}(t)[i];return o.obj||(B(o.ctor),B(o.context),o.obj=new o.ctor(o.context),B(o.obj),o.context=null,o.resolve&&o.resolve(o.obj)),o.obj}function N(t,i){const o=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!o||!o.ctor)}var W,X=t=>j(t,"platform"),U=t=>L(t,"timer"),F=t=>S(t,"video-manager");function Y(t,i,o,e){let s=t,n=o,r=t=>{try{return n(t)}catch(t){var i,o;throw null===(i=(o=self).__AMP_REPORT_ERROR)||void 0===i||i.call(o,t),t}};const a=function(){if(void 0!==W)return W;W=!1;try{const t={get capture(){return W=!0,!1}};self.addEventListener("test-options",null,t),self.removeEventListener("test-options",null,t)}catch(t){}return W}(),h=!(null==e||!e.capture);return s.addEventListener(i,r,a?e:h),()=>{null==s||s.removeEventListener(i,r,a?e:h),n=null,s=null,r=null}}function Z(t,i,o,e){const s={detail:o};return Object.assign(s,e),new t.CustomEvent(i,s)}function q(t,i,o,e){return Y(t,i,o,e)}function G(t,i,o,e){let s=o;const n=Y(t,i,(t=>{try{s(t)}finally{s=null,n()}}),e);return n}function J(t,i,o){o=o.sort(((t,i)=>i.minWidth-t.minWidth));let e=-1;o.forEach((o=>{const{className:s,minWidth:n}=o;n<=i&&n>e?(t.classList.add(s),e=n):t.classList.remove(s)}))}var K="dock-dismiss-on-tap",Q="dock-scroll-back";function tt(t){const i=t.touches?t.touches[0]:t;return{x:"x"in i?i.x:i.clientX,y:"y"in i?i.y:i.clientY}}var it="dock",ot="registered",et=["<div class=i-amphtml-video-docked-overlay hidden></div>"],st=['<div class=amp-video-docked-controls hidden><div class="amp-video-docked-main-button-group amp-video-docked-control-set-playback"><div class=amp-video-docked-button-group><div role=button ref=playButton class=amp-video-docked-play></div><div role=button ref=pauseButton class=amp-video-docked-pause></div></div><div class=amp-video-docked-button-group><div role=button ref=muteButton class=amp-video-docked-mute></div><div role=button ref=unmuteButton class=amp-video-docked-unmute></div></div><div class=amp-video-docked-button-group><div role=button ref=fullscreenButton class=amp-video-docked-fullscreen></div></div></div><div class="amp-video-docked-main-button-group amp-video-docked-control-set-scroll-back" hidden><div class=amp-video-docked-button-group><div role=button ref=scrollBackButton class=amp-video-docked-scroll-back></div></div></div><div class=amp-video-docked-button-dismiss-group ref=dismissContainer><div role=button ref=dismissButton class=amp-video-docked-dismiss></div></div></div>'],nt="playback",rt="scroll-back",at=[{className:"amp-small",minWidth:0},{className:"amp-large",minWidth:300}];function ht(t,i){T(t,!1),T(i,!0)}var dt="left",ct="right",lt="bottom";function ut(t,i,o,e){return e*(t-i-2*o)}function mt(t,i,o,e){return ut(t,i,o,e)}function pt(t,i,o,e){return ut(t,i,o,-e)}var vt=(t,i,o)=>{return(e=t)<0?e=0:e>1&&(e=1),(e-0)*(o-(s=i))/1+s;var e,s};function gt(t,i){const{height:o,width:e}=t,{height:s,left:n,top:r,width:a}=i;let h,d,c;return e/o>a/s?(c=a/e,d=r+s/2-o*c/2,h=n):(c=s/o,h=n+a/2-e*c/2,d=r),u(h,d,e*c,o*c)}function _t(t,i,o,e,s,n,r){const a=i.width,h=Math.min(r,n*a),d=t.width/t.height,c=Math.max(s,a*e),l=c/d;return u(o==ct?i.right-h-c:i.left+h,h,c,l)}var ft=t=>t.width>0&&t.height>0,kt=t=>({get:t,configurable:!1,enumerable:!0});function At(t,i,o){if(i[o])return i[o];const e=t.querySelector(`style[${o}], link[${o}]`);return e?(i[o]=e,e):null}var Pt=["<div class=amp-video-docked-shadow hidden></div>"],bt=["<div class=amp-video-docked-placeholder-background><div class=amp-video-docked-placeholder-background-poster ref=poster></div><div class=amp-video-docked-placeholder-icon ref=icon></div></div>"],Mt=.85,wt=[{className:"amp-small",minWidth:0},{className:"amp-large",minWidth:420}],Tt="i-amphtml-video-docked",Vt="slot",xt=(t,i,o)=>`translate(${t}px, ${i}px) scale(${o})`;function Et(t,i){let o=!1;return(...e)=>{o||(o=!0,t.requestAnimationFrame((()=>{i.apply(null,e),o=!1})))}}t.registerServiceForDoc("video-docking",class{constructor(t){this.zi=t,this.Fv=I((()=>F(t))),this.rc=S(t,"viewport"),this.ef=function(t){const i=kt((()=>t.getSize().width)),o=kt((()=>t.getSize().height));return Object.defineProperties(u(0,0,0,0),{width:i,height:o,right:i,bottom:o})}(this.rc),this.t2=null,this.i2=null;const i=m(this.o2());this.e2=I((()=>this.Mj((t=>t(Pt))(i)))),this.s2=I((()=>this.n2())),this.a2=I((()=>this.Mj((t=>t(bt))(i)))),this.h2=I((()=>v(this.a2()))),this.d2=null,this.c2=null,this.l2=null,this.u2=null,this.E$=this.rc.getScrollTop(),this.m2=!1,this.v2=0,this.g2=0,this._2=0,this.qi=[],this.b$=I((()=>{const t=this.zi;this.rc.onScroll(Et(t.win,(()=>this.f2()))),this.rc.onResize((()=>this.A2())),function(t,i,o,e,s){const n=t.getHeadNode();!function(t,i,o,e){let s=t.__AMP_CSS_SM;s||(s=t.__AMP_CSS_SM=d());const n=`amp-extension=${e}`;if(n){const o=At(t,s,n);if(o)return"STYLE"==o.tagName&&o.textContent!==i&&(o.textContent=i),o}const r=(t.ownerDocument||t).createElement("style");r.textContent=i;let a=null;r.setAttribute("amp-extension",e),a=At(t,s,"amp-runtime"),function(t,i,o=null){if(!o)return void function(t,i){t.insertBefore(i,t.firstChild)}(t,i);const e=o.nextSibling;t.insertBefore(i,e)}(t,r,a),n&&(s[n]=r)}(n,function(t,i){const o=t.__AMP_CSS_TR;return o?o(i):i}(n,'.amp-video-docked-controls{direction:ltr!important;opacity:0;pointer-events:none!important;transition:opacity 0.3s ease;height:120px}.amp-video-docked-main-button-group{height:40px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;margin:-20px 0 0 -60px}.amp-large>.amp-video-docked-main-button-group{margin-left:-70px}.amp-large>.amp-video-docked-main-button-group>.amp-video-docked-button-group{margin-right:10px}.amp-large>.amp-video-docked-control-set-scroll-back,.amp-small>.amp-video-docked-control-set-scroll-back{margin-left:-32px}.amp-large>.amp-video-docked-control-set-scroll-back>.amp-video-docked-button-group{margin-right:0}.amp-large>.amp-video-docked-button-dismiss-group{margin:6px 0 0 -6px}.amp-small>.amp-video-docked-button-dismiss-group,.amp-small>.amp-video-docked-button-dismiss-group>div[role=button]{min-width:32px;height:32px;border-radius:32px;background-size:20px 20px}.amp-small>.amp-video-docked-button-dismiss-group{margin-left:8px}.amp-video-docked-controls-shown{opacity:1;pointer-events:initial!important}.amp-video-docked-button-group{margin:0}.amp-video-docked-button-dismiss-group,.amp-video-docked-button-dismiss-group>div[role=button],.amp-video-docked-button-group,.amp-video-docked-button-group>div[role=button]{min-width:40px;height:40px;border-radius:40px}.amp-video-docked-button-dismiss-group:active,.amp-video-docked-button-group:active{background-color:hsla(0,0%,100%,.7)}.amp-video-docked-button-dismiss-group>div[role=button],.amp-video-docked-button-group,.amp-video-docked-button-group>div[role=button],.amp-video-docked-controls,.i-amphtml-video-docked-overlay{-webkit-tap-highlight-color:rgba(0,0,0,0)!important}.amp-video-docked-button-dismiss-group>div[role=button],.amp-video-docked-button-group>div[role=button]{background-repeat:no-repeat;background-position:50%}.amp-video-docked-shadow{box-shadow:0px 0 20px 6px rgba(0,0,0,.2);transition-property:transform,opacity!important}.amp-video-docked-controls-bg{background:hsla(0,0%,90%,.6)}.amp-video-docked-mute{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M3 9v6h4l5 5V4L7 9zm13.5 3A4.5 4.5 0 0 0 14 7.97v8.05c1.48-.73 2.5-2.25 2.5-4.02M14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77"/><path fill="none" d="M0 0h24v24H0z"/></svg>\')}.amp-video-docked-unmute{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M16.5 12A4.5 4.5 0 0 0 14 7.97v2.21l2.45 2.45c.03-.2.05-.41.05-.63m2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51A8.8 8.8 0 0 0 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71M4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06a9 9 0 0 0 3.69-1.81L19.73 21 21 19.73l-9-9zM12 4 9.91 6.09 12 8.18z"/><path fill="none" d="M0 0h24v24H0z"/></svg>\')}.amp-video-docked-pause{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M6 19h4V5H6zm8-14v14h4V5z"/><path fill="none" d="M0 0h24v24H0z"/></svg>\')}.amp-video-docked-play{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M8 5v14l11-7z"/><path fill="none" d="M0 0h24v24H0z"/></svg>\')}.amp-video-docked-fullscreen{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M7 14H5v5h5v-2H7zm-2-4h2V7h3V5H5zm12 7h-3v2h5v-5h-2zM14 5v2h3v3h2V5z"/></svg>\')}.amp-video-docked-dismiss{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/><path fill="none" d="M0 0h24v24H0z"/></svg>\')}.amp-video-docked-scroll-back{background-size:50%}.amp-rtl .amp-video-docked-scroll-back,.amp-video-docked-scroll-back{background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><g fill="none" fill-rule="evenodd"><path d="M-4-4h48v48H-4z"/><path fill="%23000" fill-rule="nonzero" d="M36 0c2.2 0 4 1.8 4 4v24c0 2.2-1.8 4-4 4H12c-2.2 0-4-1.8-4-4V4c0-2.2 1.8-4 4-4zM16 11.868l12.618 12.618 2.829-2.828L18.789 9H27V5H12v15h4zM4 8H0v28c0 2.2 1.8 4 4 4h28v-4H4z"/></g></svg>\')}.amp-video-docked-control-set-scroll-back>.amp-video-docked-button-group,.amp-video-docked-control-set-scroll-back>.amp-video-docked-button-group>div[role=button]{min-width:64px;height:64px}.amp-video-docked-shadow,.i-amphtml-video-docked,.i-amphtml-video-docked-overlay{margin:0!important}.i-amphtml-video-docked{transition-property:transform!important}.amp-video-docked-controls,.amp-video-docked-shadow,.i-amphtml-video-docked,.i-amphtml-video-docked-overlay{position:fixed!important;top:0!important;left:0!important;right:auto!important;bottom:auto!important;padding:0!important;min-width:0!important;min-height:0!important;max-width:auto!important;max-height:auto!important;transform-origin:left top!important;will-change:width,height,transition,transform,opacity;transition:transform 0.05s}.i-amphtml-video-docked-overlay{opacity:0;transition:opacity 0.3s ease;contain:strict!important}.amp-video-docked-controls-bg{opacity:1}.i-amphtml-video-docked-overlay.amp-video-docked-almost-dismissed{opacity:1;background:hsla(0,0%,39%,.1)}.i-amphtml-video-docked-shadow.amp-video-docked-almost-dismissed,.i-amphtml-video-docked.amp-video-docked-almost-dismissed{opacity:0.3}.amp-video-docked-button-dismiss-group{position:absolute;top:-40px}.amp-video-docked-placeholder-background{background:hsla(0,0%,78%,.5);transition-property:opacity;overflow:hidden;pointer-events:none;z-index:0;opacity:0}.amp-video-docked-placeholder-icon{mask-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><g fill="none" fill-rule="evenodd"><path d="M0 0h48v48H0z"/><path fill="%23000" fill-rule="nonzero" d="M40 4H16c-2.2 0-4 1.8-4 4v24c0 2.2 1.8 4 4 4h24c2.2 0 4-1.8 4-4V8c0-2.2-1.8-4-4-4M8 12H4v28c0 2.2 1.8 4 4 4h28v-4H8zm28 3.868L23.382 28.486l-2.828-2.828L33.212 13H25V9h15v15h-4z"/></g></svg>\');mask-size:48px 48px;height:48px;width:48px;mask-repeat:no-repeat;mask-position:bottom left;background:hsla(0,0%,39%,.8);transition-property:opacity,transform;will-change:opacity,transform;position:absolute;bottom:40px;left:40px}.amp-video-docked-placeholder-icon.amp-rtl{mask-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><g fill="none" fill-rule="evenodd"><path d="M-4-4h48v48H-4z"/><path fill="%23000" fill-rule="nonzero" d="M36 0c2.2 0 4 1.8 4 4v24c0 2.2-1.8 4-4 4H12c-2.2 0-4-1.8-4-4V4c0-2.2 1.8-4 4-4zM16 11.868l12.618 12.618 2.829-2.828L18.789 9H27V5H12v15h4zM4 8H0v28c0 2.2 1.8 4 4 4h28v-4H4z"/></g></svg>\');left:auto;right:40px}.amp-video-docked-placeholder-icon.amp-small{mask-size:32px 32px;width:32px;height:32px;bottom:20px;left:20px}.amp-video-docked-placeholder-icon.amp-rtl.amp-small{left:auto;right:20px}.amp-video-docked-placeholder-background-poster{background-size:cover;background-repeat:no-repeat;filter:blur(20px);transform:scale(1.1);opacity:0.3}.amp-video-docked-controls{z-index:2147483646!important}.i-amphtml-video-docked-overlay{z-index:2147483645!important}.i-amphtml-video-docked{z-index:2147483644!important}.amp-video-docked-shadow{z-index:2147483643!important}\n/*# sourceURL=/extensions/amp-video-docking/0.1/amp-video-docking.css*/'),0,"amp-video-docking")}(t,0,null)})),this.P2=I((()=>this.b2())),this.Yg=null,this.M2=!1,this.w2()}w2(){if(!this.T2())return;const t=this.zi,i=`[${it,CSS.escape("dock")}]`,o=t.getRootNode().querySelectorAll(i);for(let t=0;t<o.length;t++){const i=o[t];i.signals&&i.signals().get(ot)&&this.registerElement(i)}q(t.getBody(),ot,(t=>{const i=t.target;i.hasAttribute(it)&&this.registerElement(i)}))}T2(){return!X(this.zi.win).isIos()||!(t=this.zi,S(t,"viewer")).isEmbedded();var t}b2(){const t=this.zi.getRootNode(),i=t.querySelector("[dock]");D(i.signals().get(ot),"`dock` attribute can only be set on video components.");const o=i.getAttribute("dock").trim();if(""==o)return null;const e=t.querySelector(o);return e&&D("amp-layout"==e.tagName.toLowerCase(),"Dock slot must be an <amp-layout> element."),e}A2(){var t;this.ef.width!==(null===(t=this.t2)||void 0===t?void 0:t.viewportRect.width)&&this.qi.forEach((t=>this.V2(t)))}E2(){const t=this.R2();return t?t.getBoundingClientRect().top:0}register(t){this.b$(),this.Yg||(this.Yg=new IntersectionObserver((t=>{const i=[];for(let o=t.length-1;o>=0;o--){const{boundingClientRect:e,target:s}=t[o];i.indexOf(s)<0&&(s.getImpl().then((t=>{this.I2(t,e)})),i.push(s))}}),{threshold:[0,.1,.2,.8,.9,1]})),this.Yg.observe(t.element),this.qi.push(t)}registerElement(t){t.getImpl().then((t=>this.register(t)))}f2(){const t=this.rc.getScrollTop();if(Math.abs(t-this.E$)<5)return;const i=t>this.E$?"top":lt;this.u2=i,this.E$=t}o2(){const t=this.zi.getRootNode();return t.ownerDocument||t}Mj(t){return(this.o2().body||this.o2()).appendChild(t)}z2(t){const i=t=>this.um(t);return q(t,"touchstart",i),q(t,"mousedown",i),t}n2(){const t=new class{constructor(t){this.zi=t;const i=m(t.getBody());this.container=(t=>t(st))(i),this.overlay=(t=>t(et))(i);const o=v(this.container),e=t=>o[t];this.O2=e("dismissButton"),this.H2=e("playButton"),this.B2=e("pauseButton"),this.D2=e("muteButton"),this.j2=e("unmuteButton"),this.S2=e("fullscreenButton"),this.C2=e("scrollBackButton"),this.L2=e("dismissContainer"),this.N2=this.container.querySelectorAll(".amp-video-docked-main-button-group"),this.W2=!1,this.X2=!1,this.U2=I((()=>new class{constructor(t,i){this.Gn=U(t),this.qn=i,this.Ei=null}trigger(t,...i){this.cancel(),this.Ei=this.Gn.delay((()=>this.qn.apply(null,i)),t)}cancel(){null!==this.Ei&&(this.Gn.cancel(this.Ei),this.Ei=null)}isWaiting(){return null!==this.Ei}}(this.zi.win,(()=>{this.hide(!0)})))),this.F2=[],this.Y2=null,this.Z2=null,this.q2=null,this.tR=null,this.G2(),this.J2()}disable(){this.W2=!0}enable(){this.W2=!1}setVideo(t,i){this.q2=i,this.tR!==t&&(this.tR=t,this.UR(t))}K2(t){const i=`amp-video-docked-control-set-${t}`;!function(t,o){const{length:e}=t;for(let o=0;o<e;o++)T(s=t[o],s.classList.contains(i));var s}(this.N2)}UR(t){this.Kg();const i="click",{element:o}=t;this.F2.push(this.Q2(this.O2,i,(()=>{this.M1(K)})),this.Q2(this.H2,i,(()=>{!function(t,i){var o;(o=()=>t.play(!1),new Promise((t=>{t(o())}))).catch((t=>{k(0,t)}))}(t)})),this.Q2(this.B2,i,(()=>{t.pause()})),this.Q2(this.D2,i,(()=>{t.mute()})),this.Q2(this.j2,i,(()=>{t.unmute()})),this.Q2(this.S2,i,(()=>{t.fullscreenEnter()})),this.Q2(this.C2,i,(()=>{this.M1(Q)})),q(this.container,"mouseup",(()=>this.hideOnTimeout(800))),q(o,"playing",(()=>this.V1())),q(o,"pause",(()=>this.I1())),q(o,"muted",(()=>this.z1())),q(o,"unmuted",(()=>this.H1())),q(o,"ad_start",(()=>this.K2(rt))),q(o,"ad_end",(()=>this.K2(nt))))}M1(t){this.container.dispatchEvent(Z(this.zi.win,t,void 0))}V1(){const{B2:t,H2:i}=this;this.X2=!1,ht(i,t)}I1(){const{B2:t,H2:i}=this;this.X2=!0,ht(t,i)}z1(){const{D2:t,j2:i}=this;ht(t,i)}H1(){const{D2:t,j2:i}=this;ht(i,t)}Q2(t,i,o){return q(t,i,(()=>{this.W2||o()}))}Kg(){for(;this.F2.length>0;)this.F2.pop().call()}hideOnTimeout(t=1200){this.U2().trigger(t)}J2(){const{overlay:t}=this,i=()=>this.B1();this.Q2(t,"click",i),this.Q2(t,"mouseover",i)}B1(){this.zi.win.requestAnimationFrame((()=>{this.D1()}))}D1(){const t=F(this.zi),i=B(this.tR),o=t.isRollingAd(i),e=t.isMuted(i),s="paused"!==t.getPlayingState(i),{container:n,overlay:r}=this;T(n,!0),n.classList.add("amp-video-docked-controls-shown"),r.classList.add("amp-video-docked-controls-bg"),this.K2(o?rt:nt),T(this.H2,!s),T(this.B2,s),T(this.D2,!e),T(this.j2,e),this.j1(),this.hideOnTimeout()}positionOnVsync(t,i,o,e,s){this.q2=u(i,o,e*t,s*t);const{container:n}=this,r=t/2,a=i+e*r,h=o+s*r;J(n,t*e,at),M(n,{"transform":E(a,h)});const d=e*r-4-40,c=-(s*r-4-40);M(this.L2,{"transform":E(d,c)})}G2(){q(this.zi.getRootNode(),"mousedown",(t=>{this.S1(t.target)||this.hide(!0)}))}S1(t){return t==this.overlay||!!t.closest(".amp-video-docked-controls")}hide(t,i){const o="amp-video-docked-controls-shown",{container:e,overlay:s}=this;e.classList.contains(o)&&(t&&this.X2||(i&&(T(e,!1),T(s,!1)),s.classList.remove("amp-video-docked-controls-bg"),e.classList.remove(o)))}j1(){this.Y2||(this.Y2=q(this.overlay,"mousemove",(()=>{this.B1()})),this.Z2=q(this.overlay,"mouseout",(t=>{B(this.q2);const{x:i,y:o}=tt(t),{bottom:e,left:s,right:n,top:r}=this.q2;(i<s||i>n||o<r||o>e)&&(this.hide(!0),this.C1())})))}C1(){this.Y2&&(this.Y2(),this.Y2=null),this.Z2&&(this.Z2(),this.Z2=null)}reset(){const{container:t,overlay:i}=this,o=[i,t];T(i,!1),this.hide();for(let t=0;t<o.length;t++)R(o[t],["transform","transition","width","height"])}}(this.zi),{container:i,overlay:o}=t;return q(i,K,(()=>{this.L1()})),q(i,Q,(()=>{this.W1()})),this.z2(i),this.z2(o),this.Mj(i),this.Mj(o),t}L1(){this.s2().hide(!1,!0),this.X1(this.U1())}U1(){return B(this.t2).video}F1(t,i){if(this.m2||!this.Y1(t,i)||this.Z1(t)||this.q1(t))return null;const{element:o}=t,e=function(t){let i=-1/0,o=1/0,e=-1/0,s=1/0;for(let t=0;t<arguments.length;t++){const n=arguments[t];if(n&&(i=Math.max(i,n.left),o=Math.min(o,n.left+n.width),e=Math.max(e,n.top),s=Math.min(s,n.top+n.height),o<i||s<e))return null}return o==1/0?null:u(i,e,o-i,s-e)}(i||o.getBoundingClientRect(),this.ef);return e&&ft(e)?e.top>this.E2()?null:this.G1(t,i):null}J1(t){return(t=t.element||t).getBoundingClientRect()}V2(t){this.jo((()=>{const i=this.F1(t);i?this.K1(t,i,1):this.Q1(t)&&this.X1(t)}))}jo(t){this.zi.win.requestAnimationFrame(t)}I2(t,i){if(!this.M2)if("top"==this.u2){const o=this.F1(t,i);o&&this.t4(t,o,i)}else if(this.u2==lt){if(!this.t2)return;t===this.U1()&&this._s(t,Mt,i)&&this.X1(t,!1,i)}}q1(t){return!this.t2&&!this.Lg(t)}Z1(t){return!!this.t2&&!this.Q1(t)}Y1(t,i){const{height:o,width:e}=i||t.element.getBoundingClientRect();return e/o<.98?(function(t){const i=t.tagName.toUpperCase();O().error(i,"Minimize-to-corner (`dock`) does not support portrait video.",t)}(t.element),!1):this.ef.width>=320&&this.ef.height>=o*Mt}Lg(t=null){const i=t||this.U1();return"playing_manual"==this.Fv().getPlayingState(i)}t4(t,i,o){this.i4(t)||this.t2||this.o4(t,i,o)}o4(t,i,o){return this.K1(t,i,.05,o,!0).then((()=>new Promise((e=>{this.jo((()=>{this.K1(t,i,1,o).then(e)}))}))))}K1(t,i,o,e,s){const{element:n}=t;this.$R(n);const{relativeX:r,scale:a,x:h,y:d}=this.e4(t,i,o,e);t.hideControls();const c=this.s4(o);return this.n4(t,i,o),this.r4(t,h,d,a,o,c,r,e).then((()=>{s||this.s2().enable()}))}Bn(t,i){const o=i&&i.slot||this.R2()||this.U1().element,e=Z(this.zi.win,t,{});(t=>function(t,i){const o=C($(t));return N(o,i)?L(o,i):null}(t,"action"))(o).trigger(o,t,e,1)}i4(t){return this.d2==t&&(this._s(t.element,.02)&&this.a4(),!0)}a4(){this.d2=null}s4(t){return this.t2?300*Math.abs(t-this.t2.step):0}h4(t,i,o){return!!this.c2&&this.c2.x==t&&this.c2.y==i&&this.c2.scale==o}r4(t,i,o,s,n,r,a,h,d="fixed"){if(this.h4(i,o,s))return e||(e=Promise.resolve(void 0));this.M2=!0;const{element:c}=t,u=h||t.element.getBoundingClientRect(),{height:m,width:p}=u;this.c2={x:i,y:o,scale:s};const v=n>0?"ease-out":"ease-in",g=y(c),_=this.e2(),{overlay:f}=this.s2(),k=this.a2(),A=this.h2().icon,P=void 0!==a,b=a==dt;P&&(J(A,p,wt),A.classList.toggle("amp-rtl",b),this.s2().container.classList.toggle("amp-rtl",b));const w=this.d4(p,m),x=t=>M(t,{"opacity":n}),E=t=>M(t,{"transition-duration":`${r}ms`,"transition-timing-function":v}),R=A.classList.contains("amp-small"),I=(b?pt:mt)(p,R?32:48,R?20:40,n);return t.mutateElement((()=>{g.classList.add(Tt),M(c,{"overflow":"visible"}),T(_,!0),T(f,!0),l(this.h2().poster),l(k),this.c4(t),c.appendChild(k),this.jo((()=>{t.mutateElement((()=>{x(k),E(k),E(A),P&&M(A,{"transform":xt(I,0,1)})}))}));let e=0,n=0,r=0,a=0;"absolute"===d&&(e=u.left,n=u.top,r=c.offsetLeft,a=c.offsetTop),this.l4(t).forEach((t=>{const h=Number(t!==g),c=h*a-n;M(t,{"position":d,"left":V(h*r-e),"top":V(c),"transform":xt(i,o,s)}),E(t),(t=>{w&&M(t,{"width":V(p),"height":V(m),"min-width":V(p),"min-height":V(m)})})(t)})),x(_),this.s2().positionOnVsync(s,i,o,p,m)})),this.u4().promise(r).then((()=>{this.M2=!1}))}u4(){return U(this.zi.win)}l4(t){return[y(t.element),this.e2(),this.s2().overlay]}c4(t){const i=this.h2().poster,o=function(t){const i=t.getAttribute("poster")||t.getAttribute("data-poster");if(i)return i;const o=("amp-img[placeholder],img[placeholder],[placeholder] amp-img",t.querySelector(function(t,i){return t.replace(/^|,/g,"$&:scope ")}("amp-img[placeholder],img[placeholder],[placeholder] amp-img")));return o?o.getAttribute("src"):void 0}(t.element);o?(T(i,!0),function(t,i){for(const o in i)w(t,o,i[o])}(i,{"background-image":`url(${o})`})):T(i,!1)}d4(t,i){const o=!this.l2||this.l2.width!=t||this.l2.height!=i;return o&&(this.l2={width:t,height:i}),o}Q1(t){return!!this.t2&&this.t2.video==t}n4(t,e,s){const n=this.t2,r=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(o){i(t,o,s[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(s,i))}))}return t}({},this.ef);var a,h;this.t2={video:t,target:e,step:s,viewportRect:r},n&&n.video==t&&(a=e.rect,h=n.target.rect,a&&h&&a.left==h.left&&a.top==h.top&&a.width==h.width&&a.height==h.height)||(this.s2().setVideo(t,e.rect),this.Bn("dock",e))}m4(t){const i=this.U1(),{target:o}=this.t2,{scale:e,x:s,y:n}=this.e4(i,o,1),r=this.v4(t),a=this.g4(r);this._2=t-this.g2,this.g2=t,this.r4(i,s+t,n,e,1,0,a)}_s(t,i=1,o){const e=o||this.J1(t);if(!ft(e))return 0;const s=Math.min(e.bottom,this.ef.bottom)-Math.max(e.top,this.ef.top);return Math.max(0,s/e.height)>i-.02}um(t){if(!this.t2)return;if(this._4(Vt))return;if(this.M2)return;this.v2=0;const{x:i}=tt(t),{directionX:o}=this.t2.target,e=Et(this.zi.win,(t=>this.f4(t,o,i))),s=()=>this.A4(r),n=this.zi.getRootNode(),r=[this.P4(),this.b4(),this.M4(),q(n,"touchmove",e),q(n,"mousemove",e),G(n,"touchend",s),G(n,"mouseup",s)]}_4(t){return!!this.t2&&this.t2.target.type===t}b4(){const t=this.o2().documentElement,i="i-amphtml-select-disabled";return t.classList.add(i),()=>t.classList.remove(i)}P4(){return this.rc.disableScroll(),this.rc.resetScroll.bind(this.rc)}f4(t,i,o){if(this.t2.target.directionX!==i)return;const e=tt(t).x-o;this.v2=e,e<=10||(t.preventDefault(),t.stopPropagation(),this.s2().hide(!1,!0),this.m2=!0,this.s2().disable(),this.m4(e))}M4(){const{win:t}=this.zi;if(!X(t).isIos())return()=>{};const i=t=>t.preventDefault();return t.addEventListener("touchmove",i,{passive:!1}),()=>t.removeEventListener("touchmove",i)}A4(t){t.forEach((t=>t.call())),this.m2=!1,this.s2().enable(),Math.abs(this._2)<40?this.w4(this.v2):this.T4(this.g2,Math.sign(this._2)),this._2=0,this.g2=0,this.v2=0}T4(t,i){B(1==Math.abs(i));const o=this.U1();if(o.pause(),this._s(o,.2))return void this.V4(o,t,i);const{target:e}=B(this.t2),{width:s,x:n,y:r}=e.rect,{scale:a}=this.e4(o,e,1),h=n+t,d=1==i?this.ef.right:this.ef.left-s,c=this.x4(d-h);this.E4(),o.showControls(),this.r4(o,d,r,a,0,c).then((()=>{this.R4(o)}))}V4(t,i,o){B(1==Math.abs(o));const{target:e}=B(this.t2),{width:s,x:n,y:r}=e.rect,{scale:a}=this.e4(t,e,1),h=this.ef.width,d=n+i,c=1==o?mt(h,s,0,1):pt(h,s,0,1),l=this.x4(c-d);this.E4(),this.r4(t,c,r,a,0,l).then((()=>{this.X1(t,!0),t.showControls()}))}x4(t){return Math.min(300,Math.abs(t)/2)}v4(t){const{step:i,target:o}=this.t2,e=this.U1(),{width:s}=e.element.getBoundingClientRect(),{scale:n,x:r}=this.e4(e,o,i);return r+t+s*n/2}w4(t){const i=this.U1(),{step:o}=this.t2,e=this.g4(t);this.i2=e;const s=this.G1(i);this.t2.target=s;const{scale:n,x:r,y:a}=this.e4(i,s,o);this.r4(i,r,a,n,o,200,e)}g4(t){return this.v4(t)>=this.ef.width/2?ct:dt}e4(t,i,o,e){return function(t,i,o=1){const e=i.x<t.x?dt:ct;return{x:vt(o,t.x,i.x),y:vt(o,t.y,i.y),scale:vt(o,t.width,i.width)/t.width,relativeX:e}}(e||this.J1(t),i.rect,o)}X1(t,i,o){const e=this._s(t,Mt,o);e||(t.pause(),t.showControls()),i||this.E4();const{target:s}=B(this.t2),{relativeX:n,scale:r,x:a,y:h}=this.e4(t,s,0),d=e?this.s4(0):0;return this.r4(t,a,h,r,0,d,n,o,"absolute").then((()=>{t.showControls(),this.R4(t)}))}E4(){this.s2().disable(),this.s2().hide(!1,!0),this.Bn("undock")}R4(t){const{element:i}=t,o=y(i);return t.mutateElement((()=>{o.classList.remove(Tt);const t=this.e2(),i=this.h2().icon,e=this.a2();T(t,!1),this.s2().reset(),[o,t,e,i].forEach((t=>{R(t,["transform","transition","min-width","min-height","width","height","opacity","overflow","position","left","top"])})),this.c2=null,this.l2=null,this.t2=null}))}$R(t){const i=t.querySelector(".i-amphtml-android-poster-bug");var o,e;i&&(null===(e=(o=i).parentElement)||void 0===e||e.removeChild(o))}W1(){this.t2&&this.rc.animateScrollIntoView(this.U1().element,"center")}G1(t,i){const o=this.R2(),e=i||t.element.getBoundingClientRect();return o?{type:Vt,rect:gt(e,o.getBoundingClientRect()),slot:o}:(null===this.i2&&(this.i2="rtl"==((s=this.o2()).body.getAttribute("dir")||s.documentElement.getAttribute("dir")||"ltr")?dt:ct),{type:"corner",rect:_t(e,this.ef,this.i2,.3,180,.04,30),directionX:this.i2});var s}R2(){const t=this.P2();return t&&ft(t.getBoundingClientRect())?t:null}})})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-video-docking-0.1.mjs.map